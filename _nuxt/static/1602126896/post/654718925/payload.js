__NUXT_JSONP__("/post/654718925", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O){return {data:[{title:"java-sdkでREST APIを利用したファイルストアへの登録方法について",body:"java-sdkに、ファイルストアへの登録メソッドが実装されていないようでしたので、\r\n下記の公式REST API仕様例に基づいて、NCMBObject.javaのsave()メソッドの流れをベースに実装を試みているのですが、うまくいきません。\r\n\r\nREST API仕様例　https:\u002F\u002Fmbaas.nifcloud.com\u002Fdoc\u002Fcurrent\u002Frest\u002Ffilestore\u002FfileRegistration.html#gsc.tab=0\r\ncurl -X \"POST\" \\\r\n -H \"X-NCMB-Application-Key: 0a0b9f31bbbc90d62fa03c9cb9d3b37a5bccca69da829b59e9a4e4c720f2e3dd\" \\\r\n -H \"X-NCMB-Timestamp: 2013-09-03T07%3A03%3A59.456Z\" \\\r\n -H \"X-NCMB-Signature: oRZCfA+LwZE58gvvIHtcfQ57arSb2ViNl9qVKunwo7A=\" \\\r\n -H \"Content-Type: multipart\u002Fform-data\" \\\r\n -F \"file=@testfile4\" \\\r\n -F 'acl={\"*\":{\"write\": true, \"read\":true},\"AAA\":{\"write\":true,\"read\":true}}' \\\r\nhttps:\u002F\u002Fmbaas.api.nifcloud.com\u002F2013-09-01\u002Ffiles\u002Ftestfile4\r\n\r\n-F \"file=@testfile4\"をJAVAでどう表現すればよいかがわかりません。\r\n\r\nsave()メソッドをベースにしていますので、URI、ヘッダ部のシグネチャの取得等は正しく表現できていると思います。\r\nあとはHttpRequest.javaの25,26行目のあたりをなんとかすればできるように思うのですが。\r\n \r\nHttpRequest.javaの25,26行目\r\nOutputStreamWriter out = new OutputStreamWriter(con.getOutputStream());\r\nout.write(data.toString());\r\n\r\ndata.toString()に変えて、\r\n\"file=(base64エンコードされた文字列)\"\r\n\"file=(ファイルパス)\"\r\nなどを試したのですが、うまくいきませんでした。\r\n\r\nご指導いただけたら幸いです。よろしくお願いいたします。\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",created_at:"2020-07-10T11:37:34Z",user:{login:q,id:s,node_id:k,avatar_url:p,gravatar_id:a,url:r,html_url:t,followers_url:g,following_url:h,gists_url:i,starred_url:j,subscriptions_url:u,organizations_url:l,repos_url:m,events_url:n,received_events_url:o,type:b,site_admin:c},comments:[{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F659242500",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-659242500",issue_url:e,id:659242500,node_id:"MDEyOklzc3VlQ29tbWVudDY1OTI0MjUwMA==",user:{login:I,id:J,node_id:v,avatar_url:w,gravatar_id:a,url:x,html_url:y,followers_url:z,following_url:A,gists_url:B,starred_url:C,subscriptions_url:D,organizations_url:E,repos_url:F,events_url:G,received_events_url:H,type:b,site_admin:c},created_at:K,updated_at:K,author_association:d,body:"Java SDKの方で実装してみました。ただ、OutputStreamWriterベースだと色々大変だったので、HttpClientsに変更しています。\r\n\r\nhttps:\u002F\u002Fgithub.com\u002FNCMBMania\u002Fjava-sdk\u002Fblob\u002Fmaster\u002Fsrc\u002Fmain\u002Fjava\u002Fncmb\u002FHttpRequest.java#L61",performed_via_github_app:f},{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F662313555",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-662313555",issue_url:e,id:662313555,node_id:"MDEyOklzc3VlQ29tbWVudDY2MjMxMzU1NQ==",user:{login:q,id:s,node_id:k,avatar_url:p,gravatar_id:a,url:r,html_url:t,followers_url:g,following_url:h,gists_url:i,starred_url:j,subscriptions_url:u,organizations_url:l,repos_url:m,events_url:n,received_events_url:o,type:b,site_admin:c},created_at:L,updated_at:L,author_association:d,body:"ファイル登録まで確認できました。本当にありがとうございます。\r\n\r\n目的としては、画像をキー情報を含めた名前でファイルストアに登録し、htmlのimgタグのsrcに公開ファイルURLを指定してブラウザ上に表示したいのですが、現状では.png等のファイルを登録しても呼び出せません。\r\n\r\nMINEタイプが「 application\u002Foctet-stream 」として登録されることと何か関係ありますか？",performed_via_github_app:f},{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F662427220",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-662427220",issue_url:e,id:662427220,node_id:"MDEyOklzc3VlQ29tbWVudDY2MjQyNzIyMA==",user:{login:I,id:J,node_id:v,avatar_url:w,gravatar_id:a,url:x,html_url:y,followers_url:z,following_url:A,gists_url:B,starred_url:C,subscriptions_url:D,organizations_url:E,repos_url:F,events_url:G,received_events_url:H,type:b,site_admin:c},created_at:"2020-07-22T12:34:59Z",updated_at:"2020-07-22T12:35:19Z",author_association:d,body:"実際にWebブラウザで表示した際に、開発者ツールなどでエラーを確認できるかと思います。そのメッセージ次第かなと…\r\n\r\nもしMINEタイプが問題だとしたら、mimeTypeというパラメータで指定可能です。\r\n\r\nhttps:\u002F\u002Fgithub.com\u002FNCMBMania\u002Fncmb-dart\u002Fblob\u002Fmaster\u002Flib\u002Fsrc\u002Ffile.dart#L28",performed_via_github_app:f},{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F664130528",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-664130528",issue_url:e,id:664130528,node_id:"MDEyOklzc3VlQ29tbWVudDY2NDEzMDUyOA==",user:{login:q,id:s,node_id:k,avatar_url:p,gravatar_id:a,url:r,html_url:t,followers_url:g,following_url:h,gists_url:i,starred_url:j,subscriptions_url:u,organizations_url:l,repos_url:m,events_url:n,received_events_url:o,type:b,site_admin:c},created_at:M,updated_at:M,author_association:d,body:"HttpRequest.javaのpostメソッドを修正すべきであるような気はするのですが、\r\nMultipartEntityBuilderの利用法がわからなくてどのような形式でmimeTypeを指定すればよいのかわかりません。。。\r\n\r\n現状、ファイルストア上でimage\u002Fjpg形式で登録できているものはブラウザのhtmlのimgタグで公開URLを指定して呼び出せるのですが、application\u002Foctet-streamで登録されているものはimgタグで呼び出せません。\r\nhttps:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F518\r\n↑過去の記事で、「基本的にファイル名からmimeTypeは自動設定」とおっしゃられていますが、これはjavascriptに限定された場合の話でしょうか。\r\n",performed_via_github_app:f},{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F664141242",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-664141242",issue_url:e,id:664141242,node_id:"MDEyOklzc3VlQ29tbWVudDY2NDE0MTI0Mg==",user:{login:I,id:J,node_id:v,avatar_url:w,gravatar_id:a,url:x,html_url:y,followers_url:z,following_url:A,gists_url:B,starred_url:C,subscriptions_url:D,organizations_url:E,repos_url:F,events_url:G,received_events_url:H,type:b,site_admin:c},created_at:N,updated_at:N,author_association:d,body:"https:\u002F\u002Fhc.apache.org\u002Fhttpcomponents-client-ga\u002Fhttpmime\u002Fapidocs\u002Forg\u002Fapache\u002Fhttp\u002Fentity\u002Fmime\u002FMultipartEntityBuilder.html#addBinaryBody(java.lang.String,%20java.io.InputStream,%20org.apache.http.entity.ContentType,%20java.lang.String)\r\n\r\nによると、こうですね。ContentType.xxx を必要なものに置き換える必要があります。\r\n\r\n```\r\nbuilder.addBinaryBody(\"file\", data, ContentType.IMAGE_PNG, fileName);\r\n```\r\n\r\nContentTypeは以下で確認できます。\r\n\r\nhttps:\u002F\u002Fhc.apache.org\u002Fhttpcomponents-core-ga\u002Fhttpcore\u002Fapidocs\u002Forg\u002Fapache\u002Fhttp\u002Fentity\u002FContentType.html\r\n\r\nファイルの種類を調べて、それに合わせてContentTypeを変更する処理が必要ですが、ちょっと今は実装検討する時間がなさそうです。\r\n",performed_via_github_app:f},{url:"https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002Fcomments\u002F664161572",html_url:"https:\u002F\u002Fgithub.com\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148#issuecomment-664161572",issue_url:e,id:664161572,node_id:"MDEyOklzc3VlQ29tbWVudDY2NDE2MTU3Mg==",user:{login:q,id:s,node_id:k,avatar_url:p,gravatar_id:a,url:r,html_url:t,followers_url:g,following_url:h,gists_url:i,starred_url:j,subscriptions_url:u,organizations_url:l,repos_url:m,events_url:n,received_events_url:o,type:b,site_admin:c},created_at:O,updated_at:O,author_association:d,body:"ContentType.IMAGE_PNGを指定することでファイルストアにmimetype=image\u002Fpngで登録できるようになりました。\r\n本当に助かりました。ありがとうございました。",performed_via_github_app:f}]}],fetch:[],mutations:void 0}}("","User",false,"NONE","https:\u002F\u002Fapi.github.com\u002Frepos\u002FNIFCLOUD-mbaas\u002FUserCommunity\u002Fissues\u002F1148",null,"https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Ffollowers","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Ffollowing{\u002Fother_user}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Fgists{\u002Fgist_id}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Fstarred{\u002Fowner}{\u002Frepo}","MDQ6VXNlcjY3MDM1Mjcy","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Forgs","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Frepos","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Fevents{\u002Fprivacy}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Freceived_events","https:\u002F\u002Favatars3.githubusercontent.com\u002Fu\u002F67035272?v=4","oossss777","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777",67035272,"https:\u002F\u002Fgithub.com\u002Foossss777","https:\u002F\u002Fapi.github.com\u002Fusers\u002Foossss777\u002Fsubscriptions","MDQ6VXNlcjU3MDk=","https:\u002F\u002Favatars2.githubusercontent.com\u002Fu\u002F5709?v=4","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint","https:\u002F\u002Fgithub.com\u002Fgoofmint","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Ffollowers","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Ffollowing{\u002Fother_user}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Fgists{\u002Fgist_id}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Fstarred{\u002Fowner}{\u002Frepo}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Fsubscriptions","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Forgs","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Frepos","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Fevents{\u002Fprivacy}","https:\u002F\u002Fapi.github.com\u002Fusers\u002Fgoofmint\u002Freceived_events","goofmint",5709,"2020-07-16T08:20:19Z","2020-07-22T08:16:27Z","2020-07-27T05:39:02Z","2020-07-27T06:12:26Z","2020-07-27T07:06:04Z")));